<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ô‡∏≥‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="../../assets/css/sidebar.css">
    <link rel="stylesheet" href="../../assets/css/export.css">
    <style>
        .export-file-types button.selected {
            background-color: #2d5a5e;
            color: #fff;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <div class="dashboard-layout">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>SIRIN MUSEUM</h2>
                <div class="role">MANAGER</div>
            </div>

            <div class="user-profile">
                <div class="profile-avatar"><i class="fas fa-user"></i></div>
                <div class="profile-name" id="profileName">‡∏Ñ‡∏∏‡∏ì‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£</div>
                <div class="profile-role" id="profileRole">‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏û‡∏¥‡∏û‡∏¥‡∏ò‡∏†‡∏±‡∏ì‡∏ë‡πå</div>
                <div class="profile-time" id="sidebarLoginTime">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö: 19:52</div>
            </div>

            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="dashboard.html" class="nav-link"><i class="bi bi-bar-chart-line"></i> ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link active"><i class="bi bi-box-arrow-up"></i> ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</a>
                </li>
            </ul>
            <button class="logout-btn" onclick="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="content-header">
                <h1>‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h1>
                <p>‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏π‡πâ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏°‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≤‡∏á‡πÜ</p>
            </div>

            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="icon">üìä</div>
                    <div class="number" id="total-tables">10</div>
                    <div class="label">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
                </div>
                <div class="stat-card">
                    <div class="icon">üì•</div>
                    <div class="number" id="exports-today">0</div>
                    <div class="label">‡πÑ‡∏ü‡∏•‡πå‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
                </div>
                <div class="stat-card">
                    <div class="icon">üìÅ</div>
                    <div class="number" id="total-exports">0</div>
                    <div class="label">‡πÑ‡∏ü‡∏•‡πå‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                </div>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <button class="tab-button active" onclick="showTab('visitor-export')">üë• ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏°</button>
                <button class="tab-button" onclick="showTab('beacon-export')">üì° ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Beacon</button>
                <button class="tab-button" onclick="showTab('system-export')">‚öôÔ∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö</button>
                <button class="tab-button" onclick="showTab('export-history')">üìã ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å</button>
            </div>

            <!-- Visitor Export Tab -->
            <div id="visitor-export" class="tab-content active">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon" style="background: linear-gradient(45deg, #667eea, #764ba2);">üë•</div>
                        <div class="card-title">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏°</div>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:</label>
                            <select id="visitor-table" onchange="handleVisitorTableChange()">
                                <option value="visitors">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏°‡∏´‡∏•‡∏±‡∏Å (visitors)</option>
                                <option value="group_members">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏° (group_members)</option>
                                <option value="room_visit_summary">‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏°‡∏´‡πâ‡∏≠‡∏á (room_visit_summary)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô:</label>
                            <input type="date" id="visitor-start-date">
                        </div>

                        <div class="form-group">
                            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î:</label>
                            <input type="date" id="visitor-end-date">
                        </div>
                    </div>

                    <div class="filter-section" id="visitor-filters">
                        <div class="filter-title">‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
                        <div class="form-grid">
                            <div class="form-group" id="visitor-type-group">
                                <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ú‡∏π‡πâ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏°:</label>
                                <select id="visitor-type-filter">
                                    <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                    <option value="individual">‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</option>
                                    <option value="group">‡∏Å‡∏•‡∏∏‡πà‡∏°</option>
                                </select>
                            </div>

                            <div class="form-group" id="visitor-status-group">
                                <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</label>
                                <select id="visitor-status-filter">
                                    <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                    <option value="1">‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà</option>
                                    <option value="0">‡∏≠‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß</option>
                                </select>
                            </div>

                            <div class="form-group" id="favorite-room-group">
                                <label>‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ä‡∏∑‡πà‡∏ô‡∏ä‡∏≠‡∏ö (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏°):</label>
                                <select id="favorite-room-filter">
                                    <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                    <option value="1">‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà 1</option>
                                    <option value="2">‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà 2</option>
                                    <option value="3">‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà 3</option>
                                    <option value="4">‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà 4</option>
                                    <option value="5">‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà 5</option>
                                    <option value="6">‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà 6</option>
                                    <option value="7">‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà 7</option>
                                    <option value="8">‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà 8</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÑ‡∏ü‡∏•‡πå:</label>
                        <div class="export-file-types">
                            <button onclick="selectFileType('csv', this, 'visitor')">CSV</button>
                            <button onclick="selectFileType('excel', this, 'visitor')">Excel</button>
                            <button onclick="selectFileType('json', this, 'visitor')">JSON</button>
                        </div>
                    </div>

                    <button class="btn" onclick="exportData('visitor')">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏°</button>
                </div>
            </div>

            <!-- Beacon Export Tab -->
            <div id="beacon-export" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon" style="background: linear-gradient(45deg, #28a745, #20c997);">üì°</div>
                        <div class="card-title">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Beacon</div>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:</label>
                            <select id="beacon-table" onchange="handleBeaconTableChange()">
                                <option value="beacons">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Beacon ‡∏î‡∏¥‡∏ö (beacons)</option>
                                <option value="beacon_visits">‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡∏° Beacon (beacon_visits)</option>
                                <option value="beacon_averages">‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ Beacon (beacon_averages)</option>
                                <option value="ibeacons_tag">‡πÅ‡∏ó‡πá‡∏Å Beacon (ibeacons_tag)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô:</label>
                            <input type="date" id="beacon-start-date">
                        </div>

                        <div class="form-group">
                            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î:</label>
                            <input type="date" id="beacon-end-date">
                        </div>
                    </div>

                    <div class="filter-section" id="beacon-filters">
                        <div class="filter-title">‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
                        <div class="form-grid">
                            <div class="form-group" id="beacon-uuid-group">
                                <label>UUID ‡πÄ‡∏â‡∏û‡∏≤‡∏∞:</label>
                                <input type="text" id="uuid-filter" placeholder="‡∏Å‡∏£‡∏≠‡∏Å UUID ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ)">
                            </div>

                            <div class="form-group" id="beacon-status-group">
                                <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏ó‡πá‡∏Å:</label>
                                <select id="tag-status-filter">
                                    <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                    <option value="available">‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</option>
                                    <option value="in_use">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</option>
                                    <option value="offline">‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå</option>
                                    <option value="damaged">‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢</option>
                                </select>
                            </div>

                            <div class="form-group" id="beacon-rssi-group">
                                <label>‡∏ä‡πà‡∏ß‡∏á RSSI:</label>
                                <div style="display: flex; gap: 10px;">
                                    <input type="number" id="rssi-min" placeholder="‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î" style="width: 50%;">
                                    <input type="number" id="rssi-max" placeholder="‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î" style="width: 50%;">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÑ‡∏ü‡∏•‡πå:</label>
                        <div class="export-file-types">
                            <button onclick="selectFileType('csv', this, 'beacon')">CSV</button>
                            <button onclick="selectFileType('excel', this, 'beacon')">Excel</button>
                            <button onclick="selectFileType('json', this, 'beacon')">JSON</button>
                        </div>
                    </div>

                    <button class="btn" onclick="exportData('beacon')">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏• Beacon</button>
                </div>
            </div>

            <!-- System Export Tab -->
            <div id="system-export" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon" style="background: linear-gradient(45deg, #ffc107, #fd7e14);">‚öôÔ∏è</div>
                        <div class="card-title">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö</div>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:</label>
                            <select id="system-table" onchange="handleSystemTableChange()">
                                <option value="users">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (users)</option>
                                <option value="equipment_return_log">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå (equipment_return_log)</option>
                                <option value="hosts">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Host (hosts)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô:</label>
                            <input type="date" id="system-start-date">
                        </div>

                        <div class="form-group">
                            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î:</label>
                            <input type="date" id="system-end-date">
                        </div>
                    </div>

                    <div class="filter-section" id="system-filters">
                        <div class="filter-title">‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
                        <div class="form-grid">
                            <div class="form-group" id="system-user-role-group">
                                <label>‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ:</label>
                                <select id="user-role-filter">
                                    <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                    <option value="admin">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</option>
                                    <option value="manager">‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£</option>
                                    <option value="staff">‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÑ‡∏ü‡∏•‡πå:</label>
                        <div class="export-file-types">
                            <button onclick="selectFileType('csv', this, 'system')">CSV</button>
                            <button onclick="selectFileType('excel', this, 'system')">Excel</button>
                            <button onclick="selectFileType('json', this, 'system')">JSON</button>
                        </div>
                    </div>

                    <button class="btn" onclick="exportData('system')">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö</button>
                </div>
            </div>

            <!-- Export History Tab -->
            <div id="export-history" class="tab-content">
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å</th>
                                <th>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</th>
                                <th>‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                <th>‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö</th>
                                <th>‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå</th>
                                <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th>‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</th>
                            </tr>
                        </thead>
                        <tbody id="exportHistoryTable">
                            <tr>
                                <td colspan="7" style="text-align: center; padding: 20px;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="../../assets/js/export.js"></script>

</body>

</html>